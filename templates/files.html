{% extends 'base.html' %}
{% block content %}
<h3 class="mb-3">File Monitoring</h3>
<p class="text-secondary">Filter rentang <code>createdAt</code>, lihat ringkas file, dan ekspor ke Excel.</p>

<form class="row g-2 align-items-end mb-3" method="get">
  <div class="col-12 col-md-3">
    <label class="form-label">Start date</label>
    <input type="date" class="form-control" name="start" value="{{ start }}">
  </div>
  <div class="col-12 col-md-3">
    <label class="form-label">End date</label>
    <input type="date" class="form-control" name="end" value="{{ end }}">
  </div>
  <div class="col-12 col-md-3 d-grid">
    <button class="btn btn-primary"><i class="bi bi-funnel me-1"></i>Filter</button>
  </div>
  <div class="col-12 col-md-3 d-grid">
    <a class="btn btn-outline-success"
       href="{{ url_for('files.file_monitoring', start=start, end=end, export=1) }}">
      <i class="bi bi-file-earmark-excel me-1"></i> Export Excel
    </a>
  </div>
</form>

<div class="card">
  <div class="card-header d-flex justify-content-between">
    <span>Files</span>
    <span class="badge text-bg-secondary">{{ rows|length if rows else 0 }} items</span>
  </div>
  <div class="table-responsive">
    <table class="table table-dark table-striped align-middle mb-0 small">
      <thead>
        <tr>
          <th>#</th>
          <th>Created At</th>
          <th>Filename</th>
          <th>Type</th>
          <th>Size</th>
          <th>User</th>
        </tr>
      </thead>
      <tbody>
        {% for r in rows %}
        <tr>
          <td>{{ loop.index }}</td>
          <td>{{ r.createdAt.strftime("%Y-%m-%d %H:%M") if r.createdAt else '-' }}</td>
          <td class="fw-semibold">{{ r.filename or '-' }}</td>
          <td><code>{{ r.type or '-' }}</code></td>
          <td>{{ r.size_h }}</td>
          <td>{{ r.user or '-' }}</td>
        </tr>
        {% else %}
        <tr><td colspan="6" class="text-center text-secondary py-4">No data.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
